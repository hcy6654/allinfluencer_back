<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.allinfluencer.backend.mypage.infrastructure.mybatis.offer.OfferMapper">

    <select id="selectById"
            resultType="com.allinfluencer.backend.mypage.infrastructure.mybatis.offer.OfferMapper$OfferRow">
        SELECT
            o.id,
            o."jobPostId" AS jobPostId,
            o."senderId" AS senderId,
            o."receiverId" AS receiverId,
            o."status"::text AS status,
            o."updatedAt" AS updatedAt
        FROM offers o
        WHERE o.id = #{offerId}
        LIMIT 1
    </select>

    <update id="updateStatus">
        UPDATE offers
        SET "status" = CAST(#{status} AS "OfferStatus"),
            "updatedAt" = #{updatedAt}
        WHERE id = #{offerId}
    </update>

</mapper>
